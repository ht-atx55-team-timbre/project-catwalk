{"ast":null,"code":"var _jsxFileName = \"/home/eric-cruz/Desktop/VS/Senior-HR/FEC/project-catwalk/client/src/product-components/AddToCart.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect, useRef } from 'react';\nimport { CardContent, Button, ClickAwayListener, Grow, Popper, Paper, MenuItem, MenuList } from '@material-ui/core';\nimport { makeStyles } from '@material-ui/core/styles';\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst useStyles = makeStyles(theme => ({\n  root: {\n    '& > *': {\n      margin: theme.spacing(1)\n    },\n    display: 'flex'\n  },\n  paper: {\n    marginRight: theme.spacing(2)\n  }\n}));\n\nconst Cart = ({\n  currentStyle\n}) => {\n  _s();\n\n  const classes = useStyles();\n  const [cart, setCart] = useState(null);\n  const [sku, setSKU] = useState(null);\n  const [quantity, setQuantity] = useState(null); // const [anchorEl, setAnchorEl] = useState(null);\n  // const open = Boolean(anchorEl);\n\n  const [sizeOpen, setSizeOpen] = useState(false);\n  const [qtyOpen, setQtyOpen] = useState(false);\n  var anchorRef = useRef(document.getElementById('size'));\n  const skus = currentStyle.skus;\n\n  const handleSKUChange = e => {\n    console.log(e.target.value);\n    setSKU(e.target.value);\n    setSizeOpen(false);\n  };\n\n  const handleQtyChange = e => {\n    console.log(e.target.value);\n    setQuantity(e.target.value);\n    setQtyOpen(false);\n  };\n\n  const createQuantity = quantity => {\n    let array = [];\n\n    for (let i = 1; i <= Math.min(quantity, 15); i++) {\n      array.push(i);\n    }\n\n    return array;\n  };\n\n  const getCartContents = () => {\n    axios.get(`http://127.0.0.1:3004/cart`).then(response => {\n      // console.log('response', response.data);\n      setCart(response.data);\n      console.log('cart', cart);\n    }).catch(err => console.error(err));\n  };\n\n  const postToCart = () => {\n    if (sku && quantity) {\n      axios({\n        method: 'post',\n        url: `http://127.0.0.1:3004/cart`,\n        data: {\n          sku_id: sku,\n          count: quantity\n        }\n      }).then(res => {\n        setSKU(null);\n        setQuantity(null);\n        getCartContents();\n        anchorRef.current = document.getElementById('size');\n      }).catch(err => console.error(err));\n    }\n  };\n\n  const handleSizeToggle = () => {\n    setSizeOpen(prevOpen => !prevOpen);\n  };\n\n  const handleQtyToggle = () => {\n    setQtyOpen(prevOpen => !prevOpen);\n  };\n\n  const handleSizeClose = e => {\n    if (anchorRef.current === true && anchorRef.current.contains(e.target)) {\n      return;\n    }\n\n    setSizeOpen(false);\n  };\n\n  const handleQtyClose = e => {\n    if (anchorRef.current && anchorRef.current.contains(e.target)) {\n      return;\n    }\n\n    setQtyOpen(false);\n  };\n\n  function handleSizeListKeyDown(e) {\n    if (e.key === 'Tab') {\n      e.preventDefault();\n      console.log('e.key', e.key);\n      setSizeOpen(false);\n    }\n  }\n\n  function handleQtyListKeyDown(e) {\n    if (e.key === 'Tab') {\n      e.preventDefault();\n      console.log('e.key in qty', e.key);\n      setQtyOpen(false);\n    }\n  }\n\n  const prevSizeOpen = useRef(sizeOpen);\n  useEffect(() => {\n    if (prevSizeOpen.current === true && sizeOpen === false) {\n      if (sku) {\n        anchorRef.current.focus();\n      } else if (sku === null) {\n        anchorRef.current = document.getElementById('size');\n      }\n    }\n\n    prevSizeOpen.current = sizeOpen;\n  }, [sizeOpen, qtyOpen, sku]);\n  const prevQtyOpen = useRef(qtyOpen);\n  useEffect(() => {\n    if (prevQtyOpen.current === true && qtyOpen === false) {\n      if (anchorRef.current) {\n        anchorRef.current.focus();\n      } else if (anchorRef.current !== document.getElementById('size')) {\n        anchorRef.current = document.getElementById('qty');\n      }\n    }\n\n    prevQtyOpen.current = qtyOpen;\n  }, [qtyOpen, quantity, sku]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: classes.root,\n    display: \"inline\",\n    justifycontent: \"flex-start\",\n    children: [/*#__PURE__*/_jsxDEV(CardContent, {\n      children: [/*#__PURE__*/_jsxDEV(Button, {\n        id: \"size\",\n        variant: \"outlined\",\n        ref: anchorRef,\n        \"aria-controls\": sizeOpen ? 'size-list-grow' : undefined,\n        \"aria-haspopup\": \"true\",\n        style: {\n          borderRadius: 0,\n          borderColor: 'red'\n        },\n        onClick: handleSizeToggle,\n        children: sku && skus[sku].size ? skus[sku].size : 'size'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 160,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Popper, {\n        open: sizeOpen,\n        anchorEl: anchorRef.current,\n        role: undefined,\n        transition: true,\n        disablePortal: true,\n        children: ({\n          TransitionProps,\n          placement\n        }) => /*#__PURE__*/_jsxDEV(Grow, { ...TransitionProps,\n          style: {\n            transforOrigin: placement === 'bottom' ? 'center top' : 'center bottom'\n          },\n          children: /*#__PURE__*/_jsxDEV(Paper, {\n            children: /*#__PURE__*/_jsxDEV(ClickAwayListener, {\n              onClickAway: handleSizeClose,\n              children: /*#__PURE__*/_jsxDEV(MenuList, {\n                autoFocusItem: sizeOpen,\n                id: \"size-list-grow\",\n                onKeyDown: handleSizeListKeyDown,\n                children: Object.keys(skus).map((sku, idx) => {\n                  return /*#__PURE__*/_jsxDEV(MenuItem, {\n                    onClick: handleSKUChange,\n                    value: sku,\n                    children: skus[sku].size\n                  }, idx, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 182,\n                    columnNumber: 25\n                  }, this);\n                })\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 179,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 178,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 177,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 173,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 171,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 7\n    }, this), sku ? /*#__PURE__*/_jsxDEV(CardContent, {\n      children: [/*#__PURE__*/_jsxDEV(Button, {\n        id: \"qty\",\n        variant: \"outlined\",\n        ref: anchorRef,\n        \"aria-controls\": \"qty-list-grow\",\n        \"aria-haspopup\": \"true\",\n        style: {\n          borderRadius: 0,\n          borderColor: 'red'\n        },\n        onClick: handleQtyToggle,\n        children: quantity ? quantity : '1'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 200,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Popper, {\n        open: qtyOpen,\n        anchorEl: anchorRef.current,\n        role: undefined,\n        transition: true,\n        disablePortal: true,\n        children: ({\n          TransitionProps,\n          placement\n        }) => /*#__PURE__*/_jsxDEV(Grow, { ...TransitionProps,\n          style: {\n            transforOrigin: placement === 'center bottom'\n          },\n          children: /*#__PURE__*/_jsxDEV(Paper, {\n            children: /*#__PURE__*/_jsxDEV(ClickAwayListener, {\n              onClickAway: handleQtyClose,\n              children: /*#__PURE__*/_jsxDEV(MenuList, {\n                autoFocusItem: qtyOpen,\n                id: \"qty-list-grow\",\n                onClose: handleQtyClose,\n                onKeyDown: handleQtyListKeyDown,\n                children: createQuantity(skus[sku].quantity).map((number, idx) => {\n                  return /*#__PURE__*/_jsxDEV(MenuItem, {\n                    onClick: handleQtyChange,\n                    value: number,\n                    children: number\n                  }, idx, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 227,\n                    columnNumber: 27\n                  }, this);\n                })\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 219,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 218,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 217,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 213,\n          columnNumber: 15\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 211,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 199,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(CardContent, {\n      children: /*#__PURE__*/_jsxDEV(Button, {\n        variant: \"outlined\",\n        style: {\n          borderRadius: 0,\n          borderColor: 'primary'\n        },\n        disabled: true,\n        children: \"-\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 245,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 244,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(CardContent, {\n      children: sku && quantity ? /*#__PURE__*/_jsxDEV(Button, {\n        variant: \"outlined\",\n        style: {\n          borderRadius: 0,\n          borderColor: 'red'\n        },\n        onClick: postToCart,\n        children: \"Add to Cart\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 256,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(Button, {\n        variant: \"outlined\",\n        style: {\n          borderRadius: 0,\n          borderColor: 'primary'\n        },\n        disabled: true,\n        children: \"Add to Cart\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 263,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 254,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 158,\n    columnNumber: 5\n  }, this);\n};\n\n_s(Cart, \"tyMLJIH2JZasjfsmL6WDtO+RiOg=\", false, function () {\n  return [useStyles];\n});\n\n_c = Cart;\nexport default Cart;\n\nvar _c;\n\n$RefreshReg$(_c, \"Cart\");","map":{"version":3,"sources":["/home/eric-cruz/Desktop/VS/Senior-HR/FEC/project-catwalk/client/src/product-components/AddToCart.jsx"],"names":["React","useState","useEffect","useRef","CardContent","Button","ClickAwayListener","Grow","Popper","Paper","MenuItem","MenuList","makeStyles","axios","useStyles","theme","root","margin","spacing","display","paper","marginRight","Cart","currentStyle","classes","cart","setCart","sku","setSKU","quantity","setQuantity","sizeOpen","setSizeOpen","qtyOpen","setQtyOpen","anchorRef","document","getElementById","skus","handleSKUChange","e","console","log","target","value","handleQtyChange","createQuantity","array","i","Math","min","push","getCartContents","get","then","response","data","catch","err","error","postToCart","method","url","sku_id","count","res","current","handleSizeToggle","prevOpen","handleQtyToggle","handleSizeClose","contains","handleQtyClose","handleSizeListKeyDown","key","preventDefault","handleQtyListKeyDown","prevSizeOpen","focus","prevQtyOpen","undefined","borderRadius","borderColor","size","TransitionProps","placement","transforOrigin","Object","keys","map","idx","number"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport {\n  CardContent,\n  Button,\n  ClickAwayListener,\n  Grow,\n  Popper,\n  Paper,\n  MenuItem,\n  MenuList,\n} from '@material-ui/core';\nimport { makeStyles } from '@material-ui/core/styles';\nimport axios from 'axios';\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    '& > *': {\n      margin: theme.spacing(1),\n    },\n    display: 'flex',\n  },\n  paper: {\n    marginRight: theme.spacing(2),\n  },\n}));\n\nconst Cart = ({ currentStyle }) => {\n  const classes = useStyles();\n\n  const [cart, setCart] = useState(null);\n  const [sku, setSKU] = useState(null);\n  const [quantity, setQuantity] = useState(null);\n  // const [anchorEl, setAnchorEl] = useState(null);\n  // const open = Boolean(anchorEl);\n  const [sizeOpen, setSizeOpen] = useState(false);\n  const [qtyOpen, setQtyOpen] = useState(false);\n  var anchorRef = useRef(document.getElementById('size'));\n\n  const skus = currentStyle.skus;\n\n  const handleSKUChange = (e) => {\n    console.log(e.target.value)\n    setSKU(e.target.value);\n    setSizeOpen(false);\n  };\n\n  const handleQtyChange = (e) => {\n    console.log(e.target.value);\n    setQuantity(e.target.value);\n    setQtyOpen(false);\n  };\n\n  const createQuantity = (quantity) => {\n    let array = [];\n    for (let i = 1; i <= Math.min(quantity, 15); i++) {\n      array.push(i);\n    }\n    return array;\n  };\n\n  const getCartContents = () => {\n    axios\n      .get(`http://127.0.0.1:3004/cart`)\n      .then(response => {\n        // console.log('response', response.data);\n        setCart(response.data);\n        console.log('cart', cart);\n      })\n      .catch(err => console.error(err));\n  };\n\n  const postToCart = () => {\n    if (sku && quantity) {\n      axios({\n        method: 'post',\n        url: `http://127.0.0.1:3004/cart`,\n        data: {\n          sku_id: sku,\n          count: quantity\n        }\n      })\n        .then(res => {\n          setSKU(null);\n          setQuantity(null);\n          getCartContents();\n          anchorRef.current = document.getElementById('size');\n        })\n        .catch(err => console.error(err));\n    }\n  };\n\n  const handleSizeToggle = () => {\n    setSizeOpen(prevOpen => !prevOpen);\n  };\n\n  const handleQtyToggle = () => {\n    setQtyOpen(prevOpen => !prevOpen);\n  };\n\n  const handleSizeClose = (e) => {\n    if (anchorRef.current === true && anchorRef.current.contains(e.target)) {\n      return;\n    }\n    setSizeOpen(false);\n  };\n\n  const handleQtyClose = (e) => {\n    if (anchorRef.current && anchorRef.current.contains(e.target)) {\n      return;\n    }\n\n    setQtyOpen(false);\n  };\n\n  function handleSizeListKeyDown(e) {\n    if (e.key === 'Tab') {\n      e.preventDefault();\n      console.log('e.key', e.key);\n      setSizeOpen(false);\n    }\n  }\n\n  function handleQtyListKeyDown(e) {\n    if (e.key === 'Tab') {\n      e.preventDefault();\n      console.log('e.key in qty', e.key);\n      setQtyOpen(false);\n    }\n  }\n\n  const prevSizeOpen = useRef(sizeOpen);\n  useEffect(() => {\n    if (prevSizeOpen.current === true && sizeOpen === false) {\n      if (sku) {\n        anchorRef.current.focus();\n      } else if (sku === null) {\n        anchorRef.current = document.getElementById('size');\n      }\n    }\n\n    prevSizeOpen.current = sizeOpen;\n  }, [sizeOpen, qtyOpen, sku]);\n\n  const prevQtyOpen = useRef(qtyOpen);\n  useEffect(() => {\n    if (prevQtyOpen.current === true && qtyOpen === false) {\n      if (anchorRef.current) {\n        anchorRef.current.focus();\n      } else if (anchorRef.current !== document.getElementById('size')) {\n        anchorRef.current = document.getElementById('qty');\n      }\n    }\n\n    prevQtyOpen.current = qtyOpen;\n  }, [qtyOpen, quantity, sku]);\n\n  return (\n    <div className={classes.root} display='inline' justifycontent='flex-start'>\n      <CardContent>\n        <Button\n          id='size'\n          variant='outlined'\n          ref={anchorRef}\n          aria-controls={sizeOpen ? 'size-list-grow' : undefined}\n          aria-haspopup='true'\n          style={{ borderRadius: 0, borderColor: 'red' }}\n          onClick={handleSizeToggle}\n        >\n          {sku && skus[sku].size ? skus[sku].size : 'size'}\n        </Button>\n        <Popper open={sizeOpen} anchorEl={anchorRef.current} role={undefined} transition disablePortal>\n          {({ TransitionProps, placement }) => (\n            <Grow\n              {...TransitionProps}\n              style={{ transforOrigin: placement === 'bottom' ? 'center top' : 'center bottom' }}\n            >\n              <Paper>\n                <ClickAwayListener onClickAway={handleSizeClose}>\n                  <MenuList autoFocusItem={sizeOpen} id='size-list-grow' onKeyDown={handleSizeListKeyDown}>\n                    {Object.keys(skus).map((sku, idx) => {\n                      return (\n                        <MenuItem\n                          key={idx}\n                          onClick={handleSKUChange}\n                          value={sku}\n                        >\n                          {skus[sku].size}\n                        </MenuItem>\n                      );\n                    })}\n                  </MenuList>\n                </ClickAwayListener>\n              </Paper>\n            </Grow>\n          )}\n        </Popper>\n      </CardContent>\n      {sku ?\n        <CardContent>\n          <Button\n            id='qty'\n            variant='outlined'\n            ref={anchorRef}\n            aria-controls='qty-list-grow'\n            aria-haspopup='true'\n            style={{ borderRadius: 0, borderColor: 'red' }}\n            onClick={handleQtyToggle}\n          >\n            {quantity ? quantity : '1'}\n          </Button>\n          <Popper open={qtyOpen} anchorEl={anchorRef.current} role={undefined} transition disablePortal>\n            {({ TransitionProps, placement }) => (\n              <Grow\n                {...TransitionProps}\n                style={{ transforOrigin: placement === 'center bottom' }}\n              >\n                <Paper>\n                  <ClickAwayListener onClickAway={handleQtyClose}>\n                    <MenuList\n                      autoFocusItem={qtyOpen}\n                      id='qty-list-grow'\n                      onClose={handleQtyClose}\n                      onKeyDown={handleQtyListKeyDown}\n                    >\n                      {createQuantity(skus[sku].quantity).map((number, idx) => {\n                        return (\n                          <MenuItem\n                            key={idx}\n                            onClick={handleQtyChange}\n                            value={number}\n\n                          >\n                            {number}\n                          </MenuItem>\n                        );\n                      })}\n                    </MenuList>\n                  </ClickAwayListener>\n                </Paper>\n              </Grow>\n            )}\n          </Popper>\n        </CardContent> :\n        <CardContent>\n          <Button\n            variant='outlined'\n            style={{ borderRadius: 0, borderColor: 'primary' }}\n            disabled\n          >\n            -\n          </Button>\n        </CardContent>\n      }\n      <CardContent>\n        {sku && quantity ?\n          <Button\n            variant='outlined'\n            style={{ borderRadius: 0, borderColor: 'red' }}\n            onClick={postToCart}\n          >\n            Add to Cart\n          </Button> :\n          <Button\n            variant='outlined'\n            style={{ borderRadius: 0, borderColor: 'primary' }}\n            disabled\n          >\n            Add to Cart\n          </Button>\n        }\n      </CardContent>\n    </div>\n  );\n}\n\nexport default Cart;"]},"metadata":{},"sourceType":"module"}