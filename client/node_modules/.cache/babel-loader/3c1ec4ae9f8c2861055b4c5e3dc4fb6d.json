{"ast":null,"code":"import _objectSpread from\"/home/eric-cruz/Desktop/VS/Senior-HR/FEC/project-catwalk/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/home/eric-cruz/Desktop/VS/Senior-HR/FEC/project-catwalk/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useRef}from'react';import{CardContent,Button,ClickAwayListener,Grow,Popper,Paper,MenuItem,MenuList}from'@material-ui/core';import{makeStyles}from'@material-ui/core/styles';import axios from'axios';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var useStyles=makeStyles(function(theme){return{root:{'& > *':{margin:theme.spacing(1)},display:'flex'},paper:{marginRight:theme.spacing(2)}};});var Cart=function Cart(_ref){var currentStyle=_ref.currentStyle;var classes=useStyles();var _useState=useState(null),_useState2=_slicedToArray(_useState,2),cart=_useState2[0],setCart=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),sku=_useState4[0],setSKU=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),quantity=_useState6[0],setQuantity=_useState6[1];// const [anchorEl, setAnchorEl] = useState(null);\n// const open = Boolean(anchorEl);\nvar _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),sizeOpen=_useState8[0],setSizeOpen=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),qtyOpen=_useState10[0],setQtyOpen=_useState10[1];var anchorRef=useRef(document.getElementById('size'));var skus=currentStyle.skus;var handleSKUChange=function handleSKUChange(e){console.log(e.target.value);setSKU(e.target.value);setSizeOpen(false);};var handleQtyChange=function handleQtyChange(e){console.log(e.target.value);setQuantity(e.target.value);setQtyOpen(false);};var createQuantity=function createQuantity(quantity){var array=[];for(var i=1;i<=Math.min(quantity,15);i++){array.push(i);}return array;};var getCartContents=function getCartContents(){axios.get(\"http://127.0.0.1:3004/cart\").then(function(response){// console.log('response', response.data);\nsetCart(response.data);console.log('cart',cart);}).catch(function(err){return console.error(err);});};var postToCart=function postToCart(){if(sku&&quantity){axios({method:'post',url:\"http://127.0.0.1:3004/cart\",data:{sku_id:sku,count:quantity}}).then(function(res){setSKU(null);setQuantity(null);getCartContents();anchorRef.current=document.getElementById('size');}).catch(function(err){return console.error(err);});}};var handleSizeToggle=function handleSizeToggle(){setSizeOpen(function(prevOpen){return!prevOpen;});};var handleQtyToggle=function handleQtyToggle(){setQtyOpen(function(prevOpen){return!prevOpen;});};var handleSizeClose=function handleSizeClose(e){if(anchorRef.current===true&&anchorRef.current.contains(e.target)){return;}setSizeOpen(false);};var handleQtyClose=function handleQtyClose(e){if(anchorRef.current&&anchorRef.current.contains(e.target)){return;}setQtyOpen(false);};function handleSizeListKeyDown(e){if(e.key==='Tab'){e.preventDefault();console.log('e.key',e.key);setSizeOpen(false);}}function handleQtyListKeyDown(e){if(e.key==='Tab'){e.preventDefault();console.log('e.key in qty',e.key);setQtyOpen(false);}}var prevSizeOpen=useRef(sizeOpen);useEffect(function(){if(prevSizeOpen.current===true&&sizeOpen===false){if(sku){anchorRef.current.focus();}else if(sku===null){anchorRef.current=document.getElementById('size');}}prevSizeOpen.current=sizeOpen;},[sizeOpen,qtyOpen,sku]);var prevQtyOpen=useRef(qtyOpen);useEffect(function(){if(prevQtyOpen.current===true&&qtyOpen===false){if(anchorRef.current){anchorRef.current.focus();}else if(anchorRef.current!==document.getElementById('size')){anchorRef.current=document.getElementById('qty');}}prevQtyOpen.current=qtyOpen;},[qtyOpen,quantity,sku]);return/*#__PURE__*/_jsxs(\"div\",{className:classes.root,display:\"inline\",justifycontent:\"flex-start\",children:[/*#__PURE__*/_jsxs(CardContent,{children:[/*#__PURE__*/_jsx(Button,{id:\"size\",variant:\"outlined\",ref:anchorRef,\"aria-controls\":sizeOpen?'size-list-grow':undefined,\"aria-haspopup\":\"true\",style:{borderRadius:0,borderColor:'red'},onClick:handleSizeToggle,children:sku&&skus[sku].size?skus[sku].size:'size'}),/*#__PURE__*/_jsx(Popper,{open:sizeOpen,anchorEl:anchorRef.current,role:undefined,transition:true,disablePortal:true,children:function children(_ref2){var TransitionProps=_ref2.TransitionProps,placement=_ref2.placement;return/*#__PURE__*/_jsx(Grow,_objectSpread(_objectSpread({},TransitionProps),{},{style:{transforOrigin:placement==='bottom'?'center top':'center bottom'},children:/*#__PURE__*/_jsx(Paper,{children:/*#__PURE__*/_jsx(ClickAwayListener,{onClickAway:handleSizeClose,children:/*#__PURE__*/_jsx(MenuList,{autoFocusItem:sizeOpen,id:\"size-list-grow\",onKeyDown:handleSizeListKeyDown,children:Object.keys(skus).map(function(sku,idx){return/*#__PURE__*/_jsx(MenuItem,{onClick:handleSKUChange,value:sku,children:skus[sku].size},idx);})})})})}));}})]}),sku?/*#__PURE__*/_jsxs(CardContent,{children:[/*#__PURE__*/_jsx(Button,{id:\"qty\",variant:\"outlined\",ref:anchorRef,\"aria-controls\":\"qty-list-grow\",\"aria-haspopup\":\"true\",style:{borderRadius:0,borderColor:'red'},onClick:handleQtyToggle,children:quantity?quantity:'1'}),/*#__PURE__*/_jsx(Popper,{open:qtyOpen,anchorEl:anchorRef.current,role:undefined,transition:true,disablePortal:true,children:function children(_ref3){var TransitionProps=_ref3.TransitionProps,placement=_ref3.placement;return/*#__PURE__*/_jsx(Grow,_objectSpread(_objectSpread({},TransitionProps),{},{style:{transforOrigin:placement==='center bottom'},children:/*#__PURE__*/_jsx(Paper,{children:/*#__PURE__*/_jsx(ClickAwayListener,{onClickAway:handleQtyClose,children:/*#__PURE__*/_jsx(MenuList,{autoFocusItem:qtyOpen,id:\"qty-list-grow\",onClose:handleQtyClose,onKeyDown:handleQtyListKeyDown,children:createQuantity(skus[sku].quantity).map(function(number,idx){return/*#__PURE__*/_jsx(MenuItem,{onClick:handleQtyChange,value:number,children:number},idx);})})})})}));}})]}):/*#__PURE__*/_jsx(CardContent,{children:/*#__PURE__*/_jsx(Button,{variant:\"outlined\",style:{borderRadius:0,borderColor:'primary'},disabled:true,children:\"-\"})}),/*#__PURE__*/_jsx(CardContent,{children:sku&&quantity?/*#__PURE__*/_jsx(Button,{variant:\"outlined\",style:{borderRadius:0,borderColor:'red'},onClick:postToCart,children:\"Add to Cart\"}):/*#__PURE__*/_jsx(Button,{variant:\"outlined\",style:{borderRadius:0,borderColor:'primary'},disabled:true,children:\"Add to Cart\"})})]});};export default Cart;","map":{"version":3,"sources":["/home/eric-cruz/Desktop/VS/Senior-HR/FEC/project-catwalk/client/src/product-components/AddToCart.jsx"],"names":["React","useState","useEffect","useRef","CardContent","Button","ClickAwayListener","Grow","Popper","Paper","MenuItem","MenuList","makeStyles","axios","useStyles","theme","root","margin","spacing","display","paper","marginRight","Cart","currentStyle","classes","cart","setCart","sku","setSKU","quantity","setQuantity","sizeOpen","setSizeOpen","qtyOpen","setQtyOpen","anchorRef","document","getElementById","skus","handleSKUChange","e","console","log","target","value","handleQtyChange","createQuantity","array","i","Math","min","push","getCartContents","get","then","response","data","catch","err","error","postToCart","method","url","sku_id","count","res","current","handleSizeToggle","prevOpen","handleQtyToggle","handleSizeClose","contains","handleQtyClose","handleSizeListKeyDown","key","preventDefault","handleQtyListKeyDown","prevSizeOpen","focus","prevQtyOpen","undefined","borderRadius","borderColor","size","TransitionProps","placement","transforOrigin","Object","keys","map","idx","number"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport {\n  CardContent,\n  Button,\n  ClickAwayListener,\n  Grow,\n  Popper,\n  Paper,\n  MenuItem,\n  MenuList,\n} from '@material-ui/core';\nimport { makeStyles } from '@material-ui/core/styles';\nimport axios from 'axios';\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    '& > *': {\n      margin: theme.spacing(1),\n    },\n    display: 'flex',\n  },\n  paper: {\n    marginRight: theme.spacing(2),\n  },\n}));\n\nconst Cart = ({ currentStyle }) => {\n  const classes = useStyles();\n\n  const [cart, setCart] = useState(null);\n  const [sku, setSKU] = useState(null);\n  const [quantity, setQuantity] = useState(null);\n  // const [anchorEl, setAnchorEl] = useState(null);\n  // const open = Boolean(anchorEl);\n  const [sizeOpen, setSizeOpen] = useState(false);\n  const [qtyOpen, setQtyOpen] = useState(false);\n  var anchorRef = useRef(document.getElementById('size'));\n\n  const skus = currentStyle.skus;\n\n  const handleSKUChange = (e) => {\n    console.log(e.target.value)\n    setSKU(e.target.value);\n    setSizeOpen(false);\n  };\n\n  const handleQtyChange = (e) => {\n    console.log(e.target.value);\n    setQuantity(e.target.value);\n    setQtyOpen(false);\n  };\n\n  const createQuantity = (quantity) => {\n    let array = [];\n    for (let i = 1; i <= Math.min(quantity, 15); i++) {\n      array.push(i);\n    }\n    return array;\n  };\n\n  const getCartContents = () => {\n    axios\n      .get(`http://127.0.0.1:3004/cart`)\n      .then(response => {\n        // console.log('response', response.data);\n        setCart(response.data);\n        console.log('cart', cart);\n      })\n      .catch(err => console.error(err));\n  };\n\n  const postToCart = () => {\n    if (sku && quantity) {\n      axios({\n        method: 'post',\n        url: `http://127.0.0.1:3004/cart`,\n        data: {\n          sku_id: sku,\n          count: quantity\n        }\n      })\n        .then(res => {\n          setSKU(null);\n          setQuantity(null);\n          getCartContents();\n          anchorRef.current = document.getElementById('size');\n        })\n        .catch(err => console.error(err));\n    }\n  };\n\n  const handleSizeToggle = () => {\n    setSizeOpen(prevOpen => !prevOpen);\n  };\n\n  const handleQtyToggle = () => {\n    setQtyOpen(prevOpen => !prevOpen);\n  };\n\n  const handleSizeClose = (e) => {\n    if (anchorRef.current === true && anchorRef.current.contains(e.target)) {\n      return;\n    }\n    setSizeOpen(false);\n  };\n\n  const handleQtyClose = (e) => {\n    if (anchorRef.current && anchorRef.current.contains(e.target)) {\n      return;\n    }\n\n    setQtyOpen(false);\n  };\n\n  function handleSizeListKeyDown(e) {\n    if (e.key === 'Tab') {\n      e.preventDefault();\n      console.log('e.key', e.key);\n      setSizeOpen(false);\n    }\n  }\n\n  function handleQtyListKeyDown(e) {\n    if (e.key === 'Tab') {\n      e.preventDefault();\n      console.log('e.key in qty', e.key);\n      setQtyOpen(false);\n    }\n  }\n\n  const prevSizeOpen = useRef(sizeOpen);\n  useEffect(() => {\n    if (prevSizeOpen.current === true && sizeOpen === false) {\n      if (sku) {\n        anchorRef.current.focus();\n      } else if (sku === null) {\n        anchorRef.current = document.getElementById('size');\n      }\n    }\n\n    prevSizeOpen.current = sizeOpen;\n  }, [sizeOpen, qtyOpen, sku]);\n\n  const prevQtyOpen = useRef(qtyOpen);\n  useEffect(() => {\n    if (prevQtyOpen.current === true && qtyOpen === false) {\n      if (anchorRef.current) {\n        anchorRef.current.focus();\n      } else if (anchorRef.current !== document.getElementById('size')) {\n        anchorRef.current = document.getElementById('qty');\n      }\n    }\n\n    prevQtyOpen.current = qtyOpen;\n  }, [qtyOpen, quantity, sku]);\n\n  return (\n    <div className={classes.root} display='inline' justifycontent='flex-start'>\n      <CardContent>\n        <Button\n          id='size'\n          variant='outlined'\n          ref={anchorRef}\n          aria-controls={sizeOpen ? 'size-list-grow' : undefined}\n          aria-haspopup='true'\n          style={{ borderRadius: 0, borderColor: 'red' }}\n          onClick={handleSizeToggle}\n        >\n          {sku && skus[sku].size ? skus[sku].size : 'size'}\n        </Button>\n        <Popper open={sizeOpen} anchorEl={anchorRef.current} role={undefined} transition disablePortal>\n          {({ TransitionProps, placement }) => (\n            <Grow\n              {...TransitionProps}\n              style={{ transforOrigin: placement === 'bottom' ? 'center top' : 'center bottom' }}\n            >\n              <Paper>\n                <ClickAwayListener onClickAway={handleSizeClose}>\n                  <MenuList autoFocusItem={sizeOpen} id='size-list-grow' onKeyDown={handleSizeListKeyDown}>\n                    {Object.keys(skus).map((sku, idx) => {\n                      return (\n                        <MenuItem\n                          key={idx}\n                          onClick={handleSKUChange}\n                          value={sku}\n                        >\n                          {skus[sku].size}\n                        </MenuItem>\n                      );\n                    })}\n                  </MenuList>\n                </ClickAwayListener>\n              </Paper>\n            </Grow>\n          )}\n        </Popper>\n      </CardContent>\n      {sku ?\n        <CardContent>\n          <Button\n            id='qty'\n            variant='outlined'\n            ref={anchorRef}\n            aria-controls='qty-list-grow'\n            aria-haspopup='true'\n            style={{ borderRadius: 0, borderColor: 'red' }}\n            onClick={handleQtyToggle}\n          >\n            {quantity ? quantity : '1'}\n          </Button>\n          <Popper open={qtyOpen} anchorEl={anchorRef.current} role={undefined} transition disablePortal>\n            {({ TransitionProps, placement }) => (\n              <Grow\n                {...TransitionProps}\n                style={{ transforOrigin: placement === 'center bottom' }}\n              >\n                <Paper>\n                  <ClickAwayListener onClickAway={handleQtyClose}>\n                    <MenuList\n                      autoFocusItem={qtyOpen}\n                      id='qty-list-grow'\n                      onClose={handleQtyClose}\n                      onKeyDown={handleQtyListKeyDown}\n                    >\n                      {createQuantity(skus[sku].quantity).map((number, idx) => {\n                        return (\n                          <MenuItem\n                            key={idx}\n                            onClick={handleQtyChange}\n                            value={number}\n\n                          >\n                            {number}\n                          </MenuItem>\n                        );\n                      })}\n                    </MenuList>\n                  </ClickAwayListener>\n                </Paper>\n              </Grow>\n            )}\n          </Popper>\n        </CardContent> :\n        <CardContent>\n          <Button\n            variant='outlined'\n            style={{ borderRadius: 0, borderColor: 'primary' }}\n            disabled\n          >\n            -\n          </Button>\n        </CardContent>\n      }\n      <CardContent>\n        {sku && quantity ?\n          <Button\n            variant='outlined'\n            style={{ borderRadius: 0, borderColor: 'red' }}\n            onClick={postToCart}\n          >\n            Add to Cart\n          </Button> :\n          <Button\n            variant='outlined'\n            style={{ borderRadius: 0, borderColor: 'primary' }}\n            disabled\n          >\n            Add to Cart\n          </Button>\n        }\n      </CardContent>\n    </div>\n  );\n}\n\nexport default Cart;"]},"metadata":{},"sourceType":"module"}